<!DOCTYPE HTML>

<!-- Modeled on http://canvasjs.com/html5-javascript-dynamic-chart/ -->
<html>

<head>
	<meta charset="UTF-8">
	<script type="text/javascript">
	window.onload = function () {

		var dps = []; // dataPoints

		var chart = new CanvasJS.Chart("scroller",{
			title :{
				text: "Real Time Average Temperature"
			},			
			axisX:{
				title:"Time (s)"
			},
			axisY:{
				title:"Temperature (°C)"
			},
			data: [{
				type: "line",
				dataPoints: dps 
			}]
		});

		var history_chart = new CanvasJS.Chart("history",{
			title :{
				text: "Historical Average Temperature"
			},			
			axisX:{
				title:"Time (s)"
			},
			axisY:{
				title:"Temperature (°C)"
			},
			data: [{
				type: "line",
				dataPoints: dps 
			}]
		});

		var time = 0;
		var temp = 100;	
		var updateInterval = 100;
		var dataLength = 500; // number of dataPoints visible at any point

		var updateChart = function (count) {
			
			// =============================================================================
			// Generate Random data for test
			count = count || 1;
			// count is number of times loop runs to generate random dataPoints.
			
			for (var j = 0; j < count; j++) {	
				temp = temp +  Math.round(5 + Math.random() *(-5-5));
				dps.push({
					x: time,
					y: temp
				});
				time++;
			};
			// =============================================================================

			// =============================================================================
			// Add temperature Data
			// xVal = <INSERT TIME DATA>; // time of measurement	
			// yVal = <INSERT TEMP DATA>; // temp measured

			// dps.push({
				// x: xVal,
				// y: yVal
			// });
			// =============================================================================


			// =============================================================================
			// Scroll Chart
			if (dps.length > dataLength)
			{
				dps.shift();				
			}
			// =============================================================================
			
			// =============================================================================
			// Update Chart
			chart.render();		
			history_chart.render();
			// =============================================================================

		};

		// generates first set of dataPoints
		updateChart(dataLength); 

		// update chart after specified time. 
		setInterval(function(){updateChart()}, updateInterval); 

	}
	</script>
	<script type="text/javascript" src="./canvasjs.min.js"></script>
</head>
<body>
	<div id="header">
		<h1> EC544 Group 8 - Challenge 2</h1>
		<h3> Nest Data Visualization</h3>
		<p> Andrew Dellolis, Connor McCann, Eric Mooney, Luke Osborne</p>
	</div>

	<div id="toprow" style="height:300px; width:100%;">
		<div id="average" style="height:300px; width:300px;">
			<h1> Average Temperature</h1>
		</div>

		<div id="history" style="height:300px; width:100%;">
		</div>
	</div>

	<div id="bottomrow" style="height:300px; width:100%;">
		<div id="scroller" style="height: 300px; width:100%;">
		</div>
	</div>

	
</body>
</html>

